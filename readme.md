# Документация по работе с сервисом безакцептного списания

Данный сервис позволяет автоматически производить списания с баланса пользователя
в пользу магазина зарегистрированного в системе.

## Логика работы сервиса

1) Если плательщик не зарегистрирован в системе, то необходимо [произвести его регистрацию](register-user.md).
2) Если у пользователя недостаточно средств для оплаты (это можно проверить [запросом проверки баланса](get-balance.md)),
ему необходимо пополнить баланс.
Для оплаты необходимо [выставить счёт](create-invoice.md). Далее пользователь должен оплатить
выставленный счёт.
3) В случае если в настройках пользователя работающего по API указан "Адрес для уведомлений о успешном пополнении", то
при успешном пополнении баланса на этот адрес будет [отправлено уведомление](callback-topup-handling.md).
4) Если ранее не был создан магазин в пользу которого будут производиться платежи,
нужно [создать магазин](create-shop.md). После создания магазина нужно обратиться к менеджменту системы
Payin-payout для добавления магазина к сервисам безакцептных платежей. Менеджмент должен сообщить
вам идентификатор сервиса которым можно пользоваться для создания платежей.
5) Если уже существует магазин подключенный к сервису безакцептных платежей и пользователь с
которого требуется списать средства имеет достаточно средств на счету, можно
[создать счёт](create-without-acceptance-invoice.md) который оплатится автоматически.
6) После обработки автоматического оплачиваемого счёта в систему продавца будет 
[отправлен колбек](callback-handling.md) уведомляющий о результате обработки.

## Порядок интеграции

1) Получение ключа разработчика у менеджмента Payin-payout
2) Создание магазина
3) Обращение к менеджменту Payin-payout для подключения магазина к сервису безакцептных платежей
4) Реализация логики для отправки запросов в систему и логики для обработки уведомлений
5) Передача менеджменту адреса на который следует отправлять уведомления
6) Работа с системой, создание счетов, получение уведомлений о результатах оплаты
